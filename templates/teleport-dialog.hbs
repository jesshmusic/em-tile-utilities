<div class='form-group'>
  <label for='tileName'>{{localize 'EMPUZZLES.TileName'}}</label>
  <input type='text' name='tileName' value='{{tileName}}' />
  <p class='hint'>{{localize 'EMPUZZLES.TileNameHint'}}</p>
</div>

<div class='form-group'>
  <label for='tileImage'>{{localize 'EMPUZZLES.TileImage'}}</label>
  <div class='file-picker-group'>
    <input type='text' name='tileImage' value='{{tileImage}}' />
    <button type='button' class='file-picker' data-target='tileImage' data-type='imagevideo'>
      <i class='fas fa-file-image'></i>
    </button>
  </div>
  <p class='hint'>{{localize 'EMPUZZLES.TileImageHint'}}</p>
</div>

<div class='form-group'>
  <label for='sound'>{{localize 'EMPUZZLES.TeleportSound'}}</label>
  <div class='file-picker-group'>
    <input type='text' name='sound' value='{{sound}}' />
    <button type='button' class='file-picker' data-target='sound' data-type='audio'>
      <i class='fas fa-file-audio'></i>
    </button>
  </div>
  <p class='hint'>{{localize 'EMPUZZLES.TeleportSoundHint'}}</p>
</div>

<fieldset class='tagger'>
  <legend>Tagger (press enter to complete)</legend>
  <div class='form-group'>
    <input type='text' data-tag-input placeholder='{{localize "EMPUZZLES.CustomTagsPlaceholder"}}' />
    <input type='hidden' name='customTags' value='{{customTags}}' data-tags-hidden />
    <button type='button' data-action='addTag' style='min-width: 65px;'>Add tags</button>
    <button type='button' data-action='confirmTags' data-tooltip='Apply tag rules'>
      <i class='fas fa-check'></i>
    </button>
  </div>
  <div class='tag-container' data-tags-container></div>
  <p class='hint'>{{localize 'EMPUZZLES.CustomTagsHint'}}</p>
</fieldset>

<div class='form-group'>
  <label>
    <input type='checkbox' name='hidden' {{#if hidden}}checked{{/if}} />
    {{localize 'EMPUZZLES.HiddenTile'}}
  </label>
  <p class='hint'>{{localize 'EMPUZZLES.HiddenTileHint'}}</p>
</div>

<div class='form-group'>
  <label>
    <input type='checkbox' name='pauseGameOnTrigger' {{#if pauseGameOnTrigger}}checked{{/if}} />
    {{localize 'EMPUZZLES.PauseGameOnTrigger'}}
  </label>
  <p class='hint'>{{localize 'EMPUZZLES.PauseGameOnTriggerHint'}}</p>
</div>

<div class='form-group'>
  <label for='targetScene'>{{localize 'EMPUZZLES.TargetScene'}}</label>
  <select name='targetScene'>
    {{#each scenes as |scene|}}
      <option value='{{scene.id}}' {{#if (eq scene.id ../selectedSceneId)}}selected{{/if}}>
        {{scene.name}}
      </option>
    {{/each}}
  </select>
  <p class='hint'>{{localize 'EMPUZZLES.TargetSceneHint'}}</p>
</div>

<div class='form-group'>
  <button type='button' data-action='selectPosition' class='select-position-btn'>
    <i class='fas fa-crosshairs'></i>
    {{localize 'EMPUZZLES.SelectPosition'}}
  </button>
  {{#if teleportX}}
    <p class='position-display'>
      <strong>{{localize 'EMPUZZLES.Destination'}}:</strong>
      X: {{teleportX}}, Y: {{teleportY}}
      {{#if teleportSceneName}}
        (Scene: {{teleportSceneName}})
      {{/if}}
    </p>
  {{else}}
    <p class='hint'>{{localize 'EMPUZZLES.SelectPositionHint'}}</p>
  {{/if}}
</div>

{{#if isDifferentScene}}
  <div class='form-group warning-box'>
    <p>
      <i class='fa-solid fa-triangle-exclamation'></i>
      <strong>{{localize 'EMPUZZLES.CrossSceneTeleportWarning'}}</strong>
    </p>
    <p>
      {{localize 'EMPUZZLES.CrossSceneTeleportWarningHint'}}
    </p>
  </div>

  <div class='form-group'>
    <label>
      <input type='checkbox' name='deleteSourceToken' {{#if deleteSourceToken}}checked{{/if}} />
      {{localize 'EMPUZZLES.DeleteSourceToken'}}
    </label>
    <p class='hint'>{{localize 'EMPUZZLES.DeleteSourceTokenHint'}}</p>
  </div>

  {{#if deleteSourceToken}}
    <div class='form-group danger-box'>
      <p>
        <i class='fa-solid fa-circle-exclamation'></i>
        <strong>{{localize 'EMPUZZLES.DeleteSourceCombatWarning'}}</strong>
      </p>
      <p>
        {{localize 'EMPUZZLES.DeleteSourceCombatWarningHint'}}
      </p>
    </div>
  {{/if}}
{{/if}}

<div class='form-group'>
  <label>
    <input type='checkbox' name='createReturnTeleport' {{#if createReturnTeleport}}checked{{/if}} />
    {{localize 'EMPUZZLES.CreateReturnTeleport'}}
  </label>
  <p class='hint'>{{localize 'EMPUZZLES.CreateReturnTeleportHint'}}</p>
</div>

{{#if hasMonksTokenBar}}
  <div class='form-group'>
    <label>
      <input type='checkbox' name='hasSavingThrow' {{#if hasSavingThrow}}checked{{/if}} />
      {{localize 'EMPUZZLES.EnableSavingThrow'}}
    </label>
    <p class='hint'>{{localize 'EMPUZZLES.SavingThrowHint'}}</p>
  </div>

  {{#if hasSavingThrow}}
    <div class='form-group'>
      <label for='savingThrow'>{{localize 'EMPUZZLES.SavingThrow'}}</label>
      <select name='savingThrow'>
        <option value='ability:dex'>{{localize 'EMPUZZLES.DexteritySave'}}</option>
        <option value='ability:str'>{{localize 'EMPUZZLES.StrengthSave'}}</option>
        <option value='ability:con'>{{localize 'EMPUZZLES.ConstitutionSave'}}</option>
        <option value='ability:int'>{{localize 'EMPUZZLES.IntelligenceSave'}}</option>
        <option value='ability:wis'>{{localize 'EMPUZZLES.WisdomSave'}}</option>
        <option value='ability:cha'>{{localize 'EMPUZZLES.CharismaSave'}}</option>
      </select>
    </div>

    <div class='form-group'>
      <label for='dc'>{{localize 'EMPUZZLES.DC'}}</label>
      <input type='number' name='dc' value='15' min='1' max='30' />
    </div>

    <div class='form-group'>
      <label for='flavorText'>{{localize 'EMPUZZLES.FlavorText'}}</label>
      <input type='text' name='flavorText' value='{{flavorText}}' />
      <p class='hint'>{{localize 'EMPUZZLES.FlavorTextHint'}}</p>
    </div>
  {{/if}}
{{else}}
  <div class='form-group' style='background: rgba(255, 152, 0, 0.1); border-left: 4px solid #ff9800; padding: 0.75rem; margin-bottom: 1rem;'>
    <p style='margin: 0; color: #ff9800;'>
      <i class='fa-solid fa-circle-info'></i>
      <strong>{{localize 'EMPUZZLES.SavingThrowUnavailable'}}</strong>
    </p>
    <p style='margin: 0.5rem 0 0 0; font-size: 0.9em;'>
      {{localize 'EMPUZZLES.SavingThrowUnavailableHint'}}
    </p>
  </div>
{{/if}}
